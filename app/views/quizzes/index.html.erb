<h1>Quizzes</h1>

<ul class="nav nav-tabs" id="indexNav" role="tablist">
  <li class="nav-item">
    <a class="nav-link active" id="nav-quizzes-tab" data-toggle="tab" href="#nav-quizzes" role="tab" aria-controls="nav-quizzes" aria-selected="true">All Quizzes</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="nav-MyQuizRoom-tab" data-toggle="tab" href="#nav-MyQuizRoom" role="tab" aria-controls="nav-MyQuizRoom" aria-selected="false">My Quiz Room</a>
  </li>
  <li class="nav-item">
    <a class="nav-link" id="nav-myCreations-tab" data-toggle="tab" href="#nav-myCreations" role="tab" aria-controls="nav-myCreations" aria-selected="false">myCreations</a>
  </li>
    <li class="nav-item">
    <a class="nav-link" id="nav-Leaderboard-tab" data-toggle="tab" href="#nav-Leaderboard" role="tab" aria-controls="nav-Leaderboard" aria-selected="false">Leaderboard</a>
  </li>

</ul>
    
  <div class="tab-content" id="nav-tabContent">
    <div class="tab-pane fade show active" id="nav-quizzes" role="tabpanel" aria-labelledby="nav-quizzes-tab">
    
      <% @allQuizzes.each do |quiz| %>
        <% if !Take.find_by(quiz_id: quiz.id, user_id: current_user.id) %>
        <div class="card text-center m-2">
          <div class="card-header bg-primary text-white">
            Created by: <%= quiz.user.first_name %> <%= quiz.user.last_name %>
          </div>
          <div class="card-body">
            <h5 class="card-title font-weight-bold"><%= quiz.title %></h5>
            <p class="card-text"> <%= quiz.description %> </p>
            <% if quiz.difficulty === "Beginner"%>
              <p class="card-text text-success">
                <%= quiz.difficulty%> 
              </p>

            <% elsif quiz.difficulty === "Intermediate"%>
              <p class="card-text text-warning">
                <%= quiz.difficulty %> 
              </p>

            <% else %>
              <p class="card-text text-danger">
                <%= quiz.difficulty %> 
              </p>
            <% end %>

            <button class="btn btn-primary">
              <%= link_to "Take Quiz!", quiz_takes_path(quiz.id), class: "text-white", method: :post %> 
            </button>
          </div>
        </div>
        <% end %>
      <% end %>
    </div>
  

    <div class="tab-pane fade" id="nav-MyQuizRoom" role="tabpanel" aria-labelledby="nav-MyQuizRoom-tab">
      
      <% @takes.each do |take| %>
      <div class="card" style="width: 18rem;">
        <div class="card-body">
          <h5 class="card-title"> <%= take.quiz.title %> </h5>
            <p class="card-text">Taken: 
            <% if take.attempts? %>
            <%= take.attempts %> times</p>
            <% end %>
          <p class="card-text">Score: <%= take.score%> </p>
            <button class="btn btn-primary"> <%= link_to "Take Quiz", quiz_path(take.quiz.id), class: "text-light" %> </button>
            <button class="btn btn-danger"> <%= link_to "Delete", quiz_take_path(take.quiz.id, take.id), class: "text-light", method: :delete %> </button>
        </div>
      </div>
      <% end %>
      
    </div>

    <div class="tab-pane fade" id="nav-myCreations" role="tabpanel" aria-labelledby="nav-myCreations-tab">
      <% @myCreations.each do |quiz| %>
        
        <section class="card quiz mr-2">
        
          <section class="card-body">
            <%= link_to(quiz.title, quiz_path(quiz.id))%><br>

            <% if can?(:edit, quiz) %>
              <%= link_to(
                "Edit",
                edit_quiz_path(quiz.id)
              )%>
            <% end %>
            Â·
            <% if can?(:delete, quiz) %>
              <%= link_to( 
                "Delete", 
                quiz_path(quiz.id), 
                method: :delete, 
                data: { confirm: "Are you sure you want to delete this?" })
              %>
            <% end %>

          </section>
        </section>
      <% end %>
    </div>

 
      
  <div class="tab-pane fade" id="nav-Leaderboard" role="tabpanel" aria-labelledby="nav-Leaderboard-tab">

    </ul>
  </div>